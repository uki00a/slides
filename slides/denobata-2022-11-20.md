---
title: Denoばた会議 Monthly 第15回
description: Denoばた会議 Monthly 第15回
keywords: Deno
url: https://uki00a.github.io/slides/denobata-2022-11-20
paginate: true
---

# Denoばた会議 Monthly 第15回

<!-- _class: lead -->

---

# Deno v1.28

<!-- _class: lead -->

---

## npmパッケージサポートの安定化

`--unstable`なしでnpmパッケージを利用できます。

```shell
$ cat main.js
import chalk from "npm:chalk@5.1.2";

console.log(chalk.green("Deno"));

$ deno run --allow-read --allow-env main.js
```

---

## npmパッケージサポートの改善

- `peerDependencies`がサポート
- `deno info --json`で`npm:`がサポート
- Astroのサポートに向けた改善が進行中 (https://github.com/denoland/deno/issues/16659)

---

## ロックファイルの自動適用と生成

`deno.json(c)`が存在する場合、ロックファイル(`deno.lock`)の生成と適用が自動化されました。

```shell
$ ls
deno.json  main.js

$ deno run main.js

$ ls
deno.json  deno.lock  main.js
```

---

## `Deno.Command`が追加 (`--unstable`)

```typescript
const command = new Deno.Command("deno", {
  args: ["fmt", "--ext=json", "-"],
  stdin: "piped",
});
command.spawn();
const file = await Deno.open("deno.json");
file.readable.pipeTo(command.stdin);

const { stdout } = await command.output();
console.info(new TextDecoder().decode(stdout));

const status = await command.status;
console.info(status.success);
```

---

## `deno bench`の安定化

`deno bench`コマンドと`Deno.bench`が`--unstable`なしで利用できます。

```javascript
function sum(...numbers: Array<number>): number {
  return numbers.reduce((a, b) => a + b, 0);
}

Deno.bench("sum", () => {
  sum(1, 2, 3, 4, 5);
});
```

---

## unstable APIの安定化

以下のAPIも安定化され、`--unstable`なしで利用できるようになりました。

- `Deno.networkInterfaces()`
- `Deno.systemMemoryInfo()`
- `Deno.uid()`
- `Deno.gid()`

---

## V8がv10.9へアップグレード

[proposal-array-grouping](https://github.com/tc39/proposal-array-grouping)のサポートが入っています。

```javascript
console.log([5.6, 4.1, 3.5, 4, 5.2].group(Math.floor));
```

```shell
$ deno run --v8-flags=--harmony-array-grouping main.js
{ "3": [ 3.5 ], "4": [ 4.1, 4 ], "5": [ 5.6, 5.2 ] }
```
